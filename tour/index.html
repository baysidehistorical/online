<html>
    <head>
        <title>
            Virtual Tour - BHS Online
        </title>
        <meta name="keywords" content="bayside, historical society, fort totten, castle, bhs online" />
        <link rel="shortcut icon" href="http://www.baysidehistorical.org/favicon.ico">
        <script src = "http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src = "jscode.js"></script>
        <script src = "theSpheres.js"></script>
        <script>


            //Data for all the Spheres




            var floor = 0;
            var room = 0;
            var cAngle = -145;
            var y = -720;
            var canvas;
            var ctx;
            var currentSphere;
            Arrow.prototype.img = new Image();
            Arrow.prototype.img.src = "arrow.png";
            $(document).ready(function(){
                canvas = document.getElementById("myCanvas");
                //Testing part for auto update screen size
                    //canvas.width = screen.availWidth;
                    //canvas.height = screen.availHeight;




                //End Testing
                ctx = canvas.getContext('2d');
                currentSphere = mySpheres[0][0][0];
                currentSphere.isCurrent = true;
                currentSphere.img.onload = function(){ currentSphere.update(cAngle,y);};
                currentSphere.load();
                loadSpheres();
				displayRoom();
                $(document).keydown(function(event){
                    if (event.which == 37)
                    {
                        cAngle += 5;
                    }
                    if (event.which == 39){
                        cAngle -= 5;

                    }
                    if (event.which == 40){
                        var canvas = document.getElementById("myCanvas");
                        if (y + (currentSphere.img.height * currentSphere.scale) > canvas.height ){
                            y-=20;
                        }
                    }
                    if (event.which == 38){
                        if (y < 0) {
                            y+=20;
                        }
                    }
                    cAngle %= 360;
                    currentSphere.update(cAngle, y);
                });

                    function getMousePos(canvas, evt) {
                    var rect = canvas.getBoundingClientRect();
                    return {
                        x: evt.clientX - rect.left,
                        y: evt.clientY - rect.top
                    };
                    }


                canvas.addEventListener('click', function(evt) {
                    var mousePos = getMousePos(canvas, evt);
                    var arr = currentSphere.checkArrows(mousePos.x,mousePos.y);
                    if(arr !== null){   //Check arrows checks if an arrow was hit. If so it will return the x, y, and z of the arrow
                        currentSphere.isCurrent = false;
                        currentSphere = mySpheres[arr.x][arr.y][arr.z];                 //This will get the x, y , and z values of the arrow that was hit
                        currentSphere.isCurrent = true;
                        floor = arr.x;
						room = arr.y;
                        currentSphere.load();                                           //This will have the images loaded for that image
                        loadSpheres();
                        currentSphere.update(cAngle,y);					//This will draw the new image at the angle
                    }

                }, false);
            });


            function loadSpheres(){
                var arrows = currentSphere.myArrows;

                if (arrows != null) {
                    for(var index = 0; index < arrows.length; index++){
                        mySpheres[arrows[index].x][arrows[index].y][arrows[index].z].load();
                    }
                }
            }

            function displayRoom(){
                ctx.font = "40px Arial";
				ctx.textAlign = "center";
                ctx.fillStyle = "rgba(0,0,0,0.5)";
                ctx.fillRect(0,0,canvas.width,canvas.height * .1);
                ctx.fillStyle = "rgba(255,255,255,0.5)";
                if (floor == 0)
                {
                    if(room == 0){ctx.fillText("If the hat fits", canvas.width / 2, canvas.height * .05);}
                    if (room == 1){ctx.fillText("Throgs Neck",canvas.width/2, canvas.height * .05);}
                    if (room == 2){ctx.fillText("Dining Room",canvas.width/2, canvas.height * .05);}
					if (room == 3){ctx.fillText("Main Entrance",canvas.width/2, canvas.height * .05);}
					if (room == 4){ctx.fillText("Board Room",canvas.width/2, canvas.height * .05);}
					if (room == 5){ctx.fillText("Gift Shop",canvas.width/2, canvas.height * .05);}
                }
				else if (floor == 1){
					if(room == 0){ctx.fillText("Reception Hall",canvas.width/2, canvas.height * .05);}
					if(room == 1){ctx.fillText("Ballroom",canvas.width/2, canvas.height * .05);}
					if(room == 2){ctx.fillText("Native Bayside Exhibit room",canvas.width/2, canvas.height * .05);}
				}
				else if(floor == 2){
					if(room == 0){ctx.fillText("Third Floor Hallway",canvas.width/2, canvas.height * .05);}
					if(room == 1){ctx.fillText("Octagon Room",canvas.width/2, canvas.height * .05);}
				}
            }

            function findSphere(myImg){
                if (currentSphere.img_high == myImg) {
                    return currentSphere;
                }
                for(var floor = 0; floor < mySpheres.length; floor++){
                    for(var room = 0 ; room < mySpheres[floor].length; room++){
                        for(var pos = 0; pos < mySpheres[floor][room].length; pos++){
                            if (mySpheres[floor][room][pos].img_high == myImg) {
                                return mySpheres[floor][room][pos];
                            }
                        }
                    }
                }
            }

        </script>
        <style>



        </style>
    </head>
    <body>
        <canvas id = "myCanvas"  width = "1300" height = "650" style = "border: 1px solid black"> </canvas>
    </body>
</html>
